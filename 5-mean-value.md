---
layout: default
title: 微分中值定理
sort_order: 1
is_note: true
---

## 微分中值

> 一点可导并且 $f'(x)=0$ ，那么它是极值点。

> 闭区间连续，开区间可导，首尾函数值相同，中间存在 $f'(x)=0$ 。

- 全部相同，显然成立。

- 不相同，由于连续函数有最大值，所以有极值点。

> 拉格朗日中值定理：
>
> 条件与上面相同，但是当 $f(a)\ne f(b)$ 时，有 $x\in (a,b)$ 满足
>
>$$
>f'(x)=\frac{f(b)-f(a)}{b-a}
>$$

证明考虑 $g(x)=f(x)-\dfrac{f(b)-f(a)}{b-a}\times x,h(x)=g(x)-g(a)$

$h(a)=h(b)=0$ ，用上面那个定理就可以简单证明。

换一下形式，可以写成：

$$
f'(a+\theta\Delta x)\Delta x=f(a+\Delta x)-f(a)\\
\theta\in (0,1)
$$

---

> 已知 $n$ 次多项式 $f(n)$ 有 $n$ 个非复数根，证明 $f'(x)$ 有 $n-1$ 个非复数根。

设 $n$ 个根是 $x_1,x_2,...,x_n,x_i\le x_{i+1}$。

- $x_i< x_{i+1}$ ，根据中值定理，中间必然有导数为 $0$ 极值点。

- $x_i=x_{i+1}$ ，$[(x-x_i)^k]'=k(x-x_i)^{k-1}$ ，相当于两个变出一个根。

并且可以发现新出来的根在原来两个根中间。

因此很容易可以证明。

---

## 一次以及二次求导对应函数点性质

> 极值点：在领域中是最大或者最小值。
>
> 如果一个点是极值点，并且可导，那么 $f'(x)=0$

证明考虑，比如是极大值点，那么右极限 $\le 0$ ，左极限 $\ge 0$ ，可导说明连续，所以 $f'(x)=0$ 。

> 在区间上可导并且 $f'(x)\ge 0$ ，那么在区间上单调。

充分：拉格朗日中值，$f(x+\Delta x)-f(x)=f'(y)\Delta ,f'(y)\ge 0$ 。

必要，如果都单调了，极限显然都是 $\ge 0$ 。

> 若函数的区间满足对于任意 $x_1<x_2,a\in (0,1),f(ax_1+(1-a)x_2)\le af(x_1)+(1-a)f(x_2)$
>
> 那么该区间下凸。
>
> 符号改成 $\ge$ 就是上凸。
>
> 区间上满足 $f''(x)\ge 0$ ，说明是下凸。

充分：$f'(x)$ 是单调增。

取 $x_1<x_2,x_0=ax_1+(1-a)x_2$。

对于 $(x_1,x_0),(x_0,x_2)$ 分别用拉格朗日中值定理。

$$
f(x_0)-f(x_1)=f'(y_1)(x_0-x_1)\\
f(x_2)-f(x_0)=f'(y_2)(x_2-x_0)\\
y_1<x_0<y_2\\
f'(y_1)\le f(y_2)
$$

移项一下就可以简单证明。

必要：已经有下凸了，在函数上手动做一个二阶差分就行。

> 两侧凸性相反的点是拐点。
>
> 若一点二阶可导，并且是拐点，那么 $f''(x)=0$ 。

说明导函数前面和后面单调性不同，也就可以说明是导函数极值点，所以二阶导是 $0$ 。

> 下凸函数，$x_1,x_2...,x_n$ 的加权平均点的点值小于等于 $f(x_i)$ 的加权平均。

和下凸的定义类似，归纳。

---

## 导函数取值构造

> 一函数可导，它的导函数不一定连续，$f(x)=x^2\sin (\frac{1}{x})$，在 $0$ 处钦定 $0$ ， 此时 $0$ 处可导，但是不连续。

> 一函数在区间 $[a,b]$ 上可导，$f'(a)=x,f'(b)=y$，那么 $f'(x)$ 在 $[a,b]$ 上可以取到 $[x,y]$ 的任意值。

令 $k\in (a,b)$，那么构造 $g(x)=f(x)-kx,g'(x)=f'(x)-k$，那么 $g'(a)<0,g'(b)>0$ ，等价于需要证明区间内有 $g(x)=0$ 。

区间连续，因此有最大值最小值取到极值点，而且 $g'(a),g'(b)\ne 0$ 最大值容易证明不在端点处，所以在中间可以取到 $g'(x)=0$ 。

我们找到区间内导函数的最大值和最小值，划分一下区间就也可以证明可以取到这个区间的任意值。

因此如果 $f'(x)\ne 0$ ，那么 $f(x)$ 一定单调。

## 杂题

> $f(x)$ 在 $[a,b]$ 上满足：
>
>$$
> |f(x_1)-f(x_2)|\le (x_1-x_2)^2
>$$
>
> 证明 $f(x)=C$。

$$
\frac{f(x_1)-f(x_2)}{x1-x2}\le x_1-x_2\\
\lim_{d\to 0} \frac{f(x+d)-f(x)}{d}\le d=0\\
f'(x)=0
$$

> $f(x)$ 在 $[0,1]$ 上连续可导， 有 $f(0)=0,f(1)=1$ ，证明对于任意 $\lambda$，存在 $\eta$。
>
>$$
>f'(\eta)-\lambda(f(\eta)-\eta)=1
>$$

设 $g(x)=f(x)-x,g'(x)=f'(x)-1$，$g$ 同样连续可导。

变成证明：

$$
g'(\eta)-\lambda g(x)=0
$$

注意到是证明一个含导数的式子，那么一个想法就是，把一整个式子变成另一个函数的求导。

$$
h(x)=e^{-\lambda x}g(x)\\
h'(x)=e^{-\lambda x}g'(x)-\lambda e^{-\lambda x}g(x)\\
=e^{-\lambda x}(g'(\eta)-\lambda g(x))
$$

这样我们得到想要做的东西，那么 $h(0)=h(1)=0$ 中间必然有 $h'(\eta)=0$ 就做完了。 

> 证明存在 $\eta\in (a,b)$，使得 
>
> $$
>   ae^b-be^a=(1-\eta)e^{\eta}(a-b)
> $$

把 $a,b$ 挪到左边，那我们证明的东西就类似于一个中值定理的东西。

用最通用的柯西中值，左边是原函数相减，右边是求导，但是都有一个相除，所以构造实际上比较麻烦。

注意到 $ae^b-be^a$ 这个东西，他可以通过 $\dfrac{e^b}{b}-\dfrac{e^a}{a}$ 得到一个类似的形式，还需要配凑一下，最终可以得到：

$$
\frac{\dfrac{e^b}{b}-\dfrac{e^a}{a}}{\dfrac{1}{b}-\dfrac{1}{a}}=\frac{ae^b-be^a}{a-b}
$$

求导相除就可以得到右边的东西。

> 证明存在 $\eta\in (a,b)$，使得 
>
> $$
>   \frac{af(b)-bf(a)}{b-a}=\eta f'(\eta) -f(\eta)
> $$

和上一个题几乎一样，构造 $\dfrac{f(x)}{x}$。

> $f(x)$ 在 $(a,b)$ 连续并且二阶可导，证明存在 $\xi \in (a,b)$： 
>
>$$
>f''(\xi)(\frac{b-a}{2})^2=f(b)+f(a)-2f(\frac{a+b}{2})
>$$

令 $d=\dfrac{b-a}{2}$，$g(x)=f(x+d)-f(x)$。

$$
\frac{f(b)+f(a)-2f(\frac{a+b}{2})}{(\frac{b-a}{2})^2}=\frac{g(a+d)-g(a)}{d^2}\\
\exists \eta,g'(\eta)=\frac{g(a+d)-g(a)}{d}=f'(\eta+d)-f'(\eta)\\
\frac{g(a+d)-g(a)}{d^2}=\frac{f'(\eta+d)-f'(\eta)}{d}=f''(\xi)
$$

---

> 已知 $f(x)$ 在 $[1,\infty)$ 连续可导，已知 $e^{-x}f'(x)$ 有界，证明 $e^{-x}f(x)$ 有界。

知道了一个有界的东西，可以让它作为中值定理的右边，那么就可以说明左边东西是有界的。

由于有柯西中值定理，右边的部分可以写成 $\dfrac{f'(x)}{g'(x)}$ 所以灵活很多。

$$
\frac{f(x)-f(1)}{e^x-e}=\frac{f'(\eta)}{e^{\eta}}
$$

左边东西有界，那么容易看出 $\dfrac{f(x)}{e^x}$ 也有界。

---

> 对于正数 $a,b,c$，证明
>
>$$
>(abc)^{\frac{a+b+c}{3}}\le a^ab^bc^c
>$$


先取 $\ln$。

$$
\ln RHS=a\ln a+b\ln b+c\ln c\\
\ge \frac{a+b+c}{3}\ln \frac{a+b+c}{3}\\
\ln LHS=\frac{a+b+c}{3}(\ln a+\ln b+\ln c)\\
\le \frac{a+b+c}{3}\ln \frac{a+b+c}{3}
$$

分别用了 $x\ln x$ 的下凸和 $\ln x$ 的上凸性。

## 泰勒展开

已知任意多项式 $f$，现在我们想要用一个多项式去近似逼近它。

那么两个函数想要尽量相同，我们可以找一个固定点 $x_0$，然后在这个固定点上的 $0,1,...,n$ 阶求导，那么我们就可以得到在这个点附近近似的一个多项式函数，这个就可以求极限的时候代替原来的多项式（只差了一个高阶无穷小）。

由于此时我们固定了 $x_0$ ，想要求出每一项系数，我们想要让高次项不会影响，因此 $p(x)$ 写成 $(x-x_0)$ 形式，这样高次项带着 $(x-x_0)$ 带入 $p^{(k)}(x_0)$ 就不会影响。

$$
p(x)=\sum_{i=0}^n a_i(x-x_0)^i\\
\forall k\le n, p^{(k)}(x_0)=f^{(k)}(x_0)\\
a_k k!=f^{(k)}(x_0)\to a_i=\frac{f^{(k)}(x_0)}{k!}
$$

得到我们最后的逼近结果：

$$
p(x)=\sum_{i=0}^n \frac{f^{(i)}(x_0)}{i!} (x-x_0)^i
$$

我们自然要考察，当我们逼近成这个后，如果我们带入非 $x_0$ 的点值，是否能做到足够逼近，也就是误差是否是一个高阶无穷小。

由于前面 $(x-x_0)^n$ 都已经配了系数，我们自然想到误差是一个 $o((x-x_0)^n)$ 的东西。

这点从一阶导的 $f(x)=f(x_0)+f'(x_0)(x-x_0)+o(x-x_0)$ 也可以猜测。

$$
\lim_{x\to x_0} \frac{f(x)-p(x)}{(x-x_0)^n}=\frac{f^{(n)}(x)-p^{(n)}(x)}{n!}=0
$$

注意到 $p$ 逼近的最后一项正好就是 $f^{(n)}(x)$，所以上面正好没了，所以我们就证明了余项是 $o((x-x_0)^n)$。

这个容易发现是一阶导近似的 $n$ 阶形式。

---

能不能具体表示一下余项是啥啊，注意到这个东西是个 $(x-x_0)^n$ 还要高阶的东西，我们想类似用拉格朗日中值的东西来表示一下。

我们想，构造一个函数 $F$，满足 $F(x_0)$ 是余项 $R(x)=f(x)-p(x)$，$F(x)=0$，这样可以类似中值定理去找到 $F'(\xi)G(x-x_0)=R(x)$。注意下面 $t$ 是变量，$x$ 是定值。

$$
F(t)=f(x)-\sum_{i=0} \frac{1}{i!}f^{(i)}(t)(x-t)^i\\
F(x_0)=R(x),F(x)=0\\
$$

这里不要直接用拉格朗日中值定理，因为我们肯定想让最后的形式里面含有 $\xi$ 尽量少。

因为我们肯定是一个：

$$
\frac{F(x_0)-F(x)}{G(x_0)-G(x)}=\frac{F'(\xi)}{G'(\xi)}\\
R(x)=F(x_0)=\frac{F'(\xi)}{G'(\xi)}(G(x_0)-G(x))
$$

因此我们直接考虑求 $F'(\xi)$ 然后去消一下。

$$
F'(t)=-\sum_{i=0}^n \frac{1}{i!} (f^{(i+1)}(t)(x-t)^i-if^{(i)}(t)(x-t)^{i-1})\\
=-(\sum_{i=1}^{n+1} \frac{1}{(i-1)!} f^{(i)}(t)(x-t)^{i-1}-\sum_{i=1}^n \frac{1}{(i-1)!}f^{(i)}(t)(x-t)^{i-1})\\
=-\frac{(x-t)^n}{n!} f^{(n+1)}(t)
$$

会发现这个东西相邻两项是可以抵消的，那么我们 $G'(t)$ 任务就是把 $(x-t)^n$ 这一项消掉。

$G(t)=(x-t)^{n+1}$ 形式非常好。

$$
G'(t)=-(n+1)(x-t)^n\\
R(x)=F(x_0)=\frac{F'(\xi)}{G'(\xi)}(G(x_0)-G(x))\\
=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}
$$

这样我们就得到了余项的拉格朗日表示，这实际上是拉格朗日中值的 $n$ 阶形式，其一阶形式：

$$
f(x)=f(x_0)+f'(\xi)(x-x_0)\\
f(x)=p(x)+\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)^{n+1}(\xi\in [x,x_0])
$$

---

实际上我们也可以带 $\xi$ 来我们最后的式子里，我们直接简单的取 $G(x)=x$。有：

$$
R(x)=F(x_0)=\frac{F'(\xi)}{G'(\xi)}(G(x_0)-G(x))\\
=\frac{f^{(n+1)}(\xi)}{n!} (x-\xi)^n(x-x_0)
$$

这个式子推导很简单，但是目前还不知道有啥用，这个叫做柯西余项。

从这里也可以看出我们上面这个式子非常厉害，实际上叫做**广义余项的泰勒定理**：

$$
R(x)=\frac{G(x)-G(x_0)}{n!G'(\xi)}(x-\xi)^n f^{(n+1)}(t)
$$

从前面也可以看出，有了这个广义的，我们任意带入 $G$ 都可以得到不同的余项公式。

---

实际使用时，我们要求 $\lim_{x\to x_0}$，那么肯定是设一个 $d=\Delta x$，比较方便来表示：

$$
f(x_0+d)=\sum_{i=0}^n \frac{f^{(i)}(x_0)}{i!} d^i+o(d^n)\\
f(x_0+d)=\sum_{i=0}^n \frac{f^{(i)}(x_0)}{i!} d^i+\frac{f^{(n+1)}(x+\theta d)}{(n+1)!}d^{n+1} (\theta \in (0,1))
$$

## 插值

前面的泰勒展开基于，我们知道一个点的前 $n$ 次求导然后想办法逼近那个函数。

现在考虑更一般的情况，我有 $m$ 个不同的点值 $x_1,x_2,...,x_m$，对于 $x_i$，我知道 $f(x_i),f'(x_i)...,f^{(n_i)}(x_i)$，有 $\sum n_i=n+1$，然后就可以确定一个 $n$ 次多项式满足在这些点值上全部满足。

怎么求这个多项式呢，没什么简单的做法，一般的做法是待定系数然后解线性方程组，但是方程组也没有比较一般的形式。

但是这东西可以估计余项，也就是如果有一个多项式 $p(x)$ 满足了这 $n$ 个点值上都相同，我可以估计误差的范围。

范围证明，非常 hard，由于解决的问题和上面的类似，结果式子也比较一样，其实不如直接记。

$$
r(x)=f(x)-p(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}\prod_{i=1}^m (x-x_i)^{n_i}
$$

$\xi$ 在所有点值与询问点 $x$ 的最小值到最大值区间里面。

毛看看感觉，其实没啥大用，毕竟我还是不知道多项式是啥，只是求了一个误差估计。

至于为啥唯一确定呢，因为每个点如果有多阶导数也固定相当于是一个重根，影响不大。

插值的特例是拉插和泰勒展开，拉插太简单，直接 skip。

## 泰勒展开的应用相关

上面讲了一大堆，实际上真正使用泰勒展开时一般就是在 $x=0$ 处展开即可。

$$
f(x)=\sum_{i=0} \frac{f^{(i)}(x)}{i!}x^i=\sum_{i=0}^n \frac{f^{(i)}(x)}{i!}x^i+r_n(x)
$$

前者是无限项，后者多了一个余项。

然后这个东西，主要就是用来做题，所以需要熟练使用一些简单的。（学过一些 EGF 好像还是有点用的）。

$$
e^x=\sum_{i=0} \frac{x^i}{i!}\\
-\ln(1-x)=\sum_{i=1} \frac{x^i}{i}\\
\sin x=\sum_{n=0} \frac{(-1)^n}{(2n+1)!}x^{2n+1}\\
\cos x=\sum_{n=0} \frac{(-1)^n}{(2n)!}x^{2n}\\
(1+x)^{a}=\sum_{n=0} \frac{a^{\underline n}}{n!} x^n
$$

从这里可以简单发现

$$
e^x=\cos ix-i\sin ix\\
e^{i\pi}=\cos (-\pi)-i\sin (-\pi)=-1
$$

可以多用换元技巧，写起来很简单。

怎么换元呢，比如我们要求 $x=a$ 处的泰勒展开，我令 $u=g(x)$，那么换元就变成求 $u=g(a)$ 处的展开。

还有一个左右同时求导的 trick：

$$
f(x)=\sum a_ix_i\\
f'(x)=\sum ia_ix^{i-1}
$$

因此如果有一个比较陌生的东西，但是求导几次后可以变成一个熟悉的东西，那么倒推一下就行。

比如 $(\text{arctan} x)'=\dfrac{1}{1+x^2}$，我们就可以倒推。

在各种证明不等式或者求极限之类的里面拉格朗日余项的写法非常方便。